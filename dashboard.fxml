<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.*?>

<BorderPane xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
            fx:controller="dronefleet.DashboardController" stylesheets="@style.css">

    <!-- HEADER -->
    <top>
        <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-background-color:#2c3e50;">
            <padding><Insets top="15" right="20" bottom="15" left="20"/></padding>
            <Label text="DroneFleet Manager" style="-fx-text-fill:white; -fx-font-size:20; -fx-font-weight:bold;"/>
            <Pane HBox.hgrow="ALWAYS" />
            <Label fx:id="userInfoLabel" text="User Info" style="-fx-text-fill:white; -fx-font-size:12;"/>
            <Region prefWidth="20"/>
            <Button text="Logout" onAction="#onLogout" styleClass="button-danger"/>
        </HBox>
    </top>

    <center>
        <VBox spacing="20" style="-fx-padding: 20;">
            
            <!-- CARDURI STATISTICI (Admin/Tehnician) -->
            <HBox fx:id="statsBox" spacing="20">
                <VBox styleClass="card" HBox.hgrow="ALWAYS" alignment="CENTER">
                    <Label text="TOTAL DRONE" styleClass="label-dim"/>
                    <Label fx:id="totalDronesLabel" text="0" style="-fx-font-size:36; -fx-text-fill:#3498db; -fx-font-weight:bold;"/>
                </VBox>
                <VBox styleClass="card" HBox.hgrow="ALWAYS" alignment="CENTER">
                    <Label text="FLOTA ACTIVA" styleClass="label-dim"/>
                    <Label fx:id="activeDronesLabel" text="0" style="-fx-font-size:36; -fx-text-fill:#2ecc71; -fx-font-weight:bold;"/>
                </VBox>
                <VBox fx:id="inDeliveryCard" styleClass="card" HBox.hgrow="ALWAYS" alignment="CENTER">
                    <Label text="IN LIVRARE" styleClass="label-dim"/>
                    <Label fx:id="inDeliveryLabel" text="0" style="-fx-font-size:36; -fx-text-fill:#9b59b6; -fx-font-weight:bold;"/>
                </VBox>
                <VBox styleClass="card" HBox.hgrow="ALWAYS" alignment="CENTER">
                    <Label text="IN SERVICE" styleClass="label-dim"/>
                    <Label fx:id="maintenanceLabel" text="0" style="-fx-font-size:36; -fx-text-fill:#e74c3c; -fx-font-weight:bold;"/>
                </VBox>
            </HBox>

            <!-- ========== SECTIUNE DRONE (Admin/Tehnician) ========== -->
            <VBox fx:id="droneSection" spacing="10" VBox.vgrow="ALWAYS">
                <Label fx:id="sectionTitle" text="Monitorizare Flota (Live)" styleClass="h2"/>
                
                <TableView fx:id="droneTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colId" text="ID" prefWidth="60" />
                        <TableColumn fx:id="colModel" text="Model" prefWidth="180" />
                        <TableColumn fx:id="colType" text="Tip" prefWidth="100" />
                        <TableColumn fx:id="colStatus" text="Status" prefWidth="100" />
                        <TableColumn fx:id="colPayload" text="Capacitate" prefWidth="100" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="colMissionType" text="Tip Misiune" prefWidth="120" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="colTime" text="Timp Ramas" prefWidth="100" style="-fx-alignment: CENTER;"/>
                    </columns>
                    <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
                </TableView>
            </VBox>

            <!-- ========== SECTIUNE CERERI PENDING - ADMIN ========== -->
            <VBox fx:id="adminRequestSection" spacing="10" visible="false" managed="false">
                <Separator/>
                <Label text="Cereri de Livrare in Asteptare" styleClass="h2" style="-fx-text-fill:#e67e22;"/>
                
                <TableView fx:id="pendingRequestTable" prefHeight="180">
                    <columns>
                        <TableColumn fx:id="colPendingId" text="ID" prefWidth="50" />
                        <TableColumn fx:id="colPendingOperator" text="Operator" prefWidth="120" />
                        <TableColumn fx:id="colPendingStart" text="Start" prefWidth="120" />
                        <TableColumn fx:id="colPendingEnd" text="Destinatie" prefWidth="120" />
                        <TableColumn fx:id="colPendingWeight" text="Greutate (kg)" prefWidth="90" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="colPendingNotes" text="Note" prefWidth="150" />
                        <TableColumn fx:id="colPendingDate" text="Data Cerere" prefWidth="140" />
                    </columns>
                    <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
                </TableView>
                
                <HBox spacing="10" alignment="CENTER_RIGHT">
                    <Button fx:id="acceptRequestButton" text="✓ Accepta Cererea" onAction="#acceptRequest" styleClass="button-success"/>
                    <Button fx:id="rejectRequestButton" text="✗ Respinge" onAction="#rejectRequest" styleClass="button-danger"/>
                </HBox>
            </VBox>

            <!-- ========== SECTIUNE CERERI OPERATOR ========== -->
            <VBox fx:id="operatorSection" spacing="10" visible="false" managed="false" VBox.vgrow="ALWAYS">
                <Label text="Cererile Mele de Livrare" styleClass="h2"/>
                
                <TableView fx:id="requestTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colRequestId" text="ID" prefWidth="60" />
                        <TableColumn fx:id="colRequestStatus" text="Status" prefWidth="120" />
                        <TableColumn fx:id="colWeight" text="Greutate (kg)" prefWidth="100" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="colDroneAssigned" text="Drona Alocata" prefWidth="150" />
                        <TableColumn fx:id="colRequestDate" text="Data Cerere" prefWidth="180" />
                    </columns>
                    <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
                </TableView>
            </VBox>

            <!-- BUTOANE ACTIUNI -->
            <HBox spacing="10" alignment="CENTER_RIGHT">
                <Label fx:id="statusLabel" HBox.hgrow="ALWAYS" style="-fx-font-size:12; -fx-font-weight:bold;"/>
                
                <!-- Butoane Admin -->
                <Button fx:id="addDroneButton" text="+ Adauga Drona" onAction="#addDrone" styleClass="button" />
                <Button fx:id="setMaintenanceButton" text="Trimite in Service" onAction="#setMaintenance" styleClass="button" style="-fx-background-color: #f39c12; -fx-text-fill:white;"/>
                <Button fx:id="removeDroneButton" text="Sterge Drona" onAction="#removeDrone" styleClass="button-danger" />
                
                <!-- Buton Tehnician -->
                <Button fx:id="removeMaintenanceButton" text="✓ Scoate din Mentenanta" onAction="#removeMaintenance" styleClass="button-success" visible="false" managed="false"/>
                
                <Region prefWidth="20"/>
                
                <!-- Buton Planificare (Admin/Operator) -->
                <Button fx:id="openMapButton" text="Planifica Misiune (Harta)" onAction="#openMap" styleClass="button-success" style="-fx-font-size:14px; -fx-padding: 10 20;"/>
            </HBox>
        </VBox>
    </center>
</BorderPane>
